<template>  <Header :current-user="currentUser"/>  <div v-if="loading" class="position-fixed start-50 mt-4" style="z-index: 1000; top: -5px;">    <div class="spinner-border" role="status">      <span class="visually-hidden">Loading...</span>    </div>  </div>  <div class="input-group mb-3 mt-2 w-25 mx-auto">    <input type="text" class="form-control" placeholder="Search a car..." v-model="searchCar" aria-label="Username" aria-describedby="basic-addon1">    <button class="input-group-text" id="basic-addon1" @click="searchCarFetch">Search</button>  </div>  <!-- Modal -->  <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">    <div class="modal-dialog">      <div class="modal-content">        <div class="modal-header">          <h5 class="modal-title" id="staticBackdropLabel">Are you sure?</h5>          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>        </div>        <div class="modal-body">          Are you sure you want to delete this post?        </div>        <div class="modal-footer">          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" @click="() =>          {            this.deleteCarConfirm = true            this.deleteCar()          }">            Delete          </button>        </div>      </div>    </div>  </div>  <div class="cars-wrapper mt-5">    <div v-if="!skeleton" v-for="car in cars" class="card box shadow-lg" style="width: 25rem;" id="car-card">      <div class="card-header" style="height: 40px; background: transparent">        <p>{{ car.user.name }}</p>      </div>      <div :style="`background-image: url(http://localhost/imgs/${car.image});`" id="card-image"></div>      <div class="card-body">        <h5 class="card-title">{{car.brand}}</h5>        <p class="card-text">{{car.model}}</p>        <p class="card-text">{{car.year}}</p>        <p class="card-text">{{ (car.price / 100).toLocaleString('pt-br',{style: 'currency', currency: 'BRL'})}}</p>       <router-link :to="{name: 'aboutCar', params: {carId: car.id}}"><a :class="`btn btn-primary ${car.user.id !== currentUser.id ? 'w-100' : ''}`">More</a></router-link>        <a v-if="car.user_id == currentUser.id" href="#" data-bs-toggle="modal" data-bs-target="#staticBackdrop" class="btn btn-primary mx-2" @click="deleteCar(car.id)">Delete</a>        <router-link v-if="car.user_id == currentUser.id"  :to="{name: 'editCar', params: {carId: car.id}}"><a href="#" class="btn btn-primary">Edit</a></router-link>      </div>    </div>  </div>  <div class="cars-wrapper" v-if="skeleton">    <div v-for="car in this.cars" class="card" aria-hidden="true" style="width: 25rem">      <div class="card-img-top" style="height: 300px; background: rgb(134, 142, 150);"></div>      <div class="card-body">        <h5 class="card-title placeholder-glow">          <span class="placeholder col-6"></span>        </h5>        <p class="card-text placeholder-glow">          <span class="placeholder col-7"></span>          <span class="placeholder col-4"></span>          <span class="placeholder col-4"></span>          <span class="placeholder col-6"></span>          <span class="placeholder col-8"></span>        </p>        <a href="#" tabindex="-1" class="btn btn-primary disabled placeholder col-6"></a>      </div>    </div>  </div></template><script>import Header from '../components/Header.vue';import axios from "../axios";export default {  name: "Home",  components: {    Header,  },  data() {    return {      comments: [],      cars: [],      loading: false,      skeleton: true,      deleteCarId: null,      deleteCarConfirm: false,      currentUser: null,      searchCar: '',    }  },  beforeCreate() {    axios.get('http://localhost/api/user')        .then((response) => {          this.currentUser = response.data        })        .catch(error => {          window.location.replace('http://localhost:3000/login')        })  },  beforeMount() {      axios.get('http://localhost/api/cars')          .then((response) => {            for(let car of response.data.cars){              for(let user of response.data.users){                if(car.user_id === user.id){                  car.user = user;                  this.cars.push(car);                }              }            }              this.cars = response.data.cars;              setTimeout(() => {                this.skeleton = false;              }, 700);          }).catch((error) => console.log(error))  },  destroyed() {    this.currentUser = null;  },  methods: {    deleteCar(car_id)    {     if(this.deleteCarConfirm){       this.loading = true;       setTimeout(() => {         this.loading = false;         this.cars.forEach((car, key) => {           if(car.id === this.deleteCarId){             this.cars.splice(key, 1);           }         })         let url = `http://localhost/api/destroy/${this.deleteCarId}`;         axios.delete(url)             .then((response) => {               console.log(response)             }).catch((error) => console.log(error))       }, 500)       this.deleteCarConfirm = false;     }else {       this.deleteCarId = car_id;     }    },    searchCarFetch() {        axios.get('http://localhost/api/search', {          params: {            search: this.searchCar,          },        }).then((response) => {          this.cars = [];          for(let car of response.data.cars){            for(let user of response.data.users){              console.log(user)              if(car.user_id === user.id){                car.user = user;                this.cars.push(car);              }            }          }        }).catch((error) => console.log(error))    }  }}</script><style scoped>.cars-wrapper{  display: grid;  width: 100%;  grid-template-columns: auto auto auto;  justify-content: center;  row-gap: 70px;  column-gap: 70px;}#car-card{  transition: .6s;}#car-card:hover{  transform: translateY(-7px);}#card-image{  width: 100%;  height: 300px;  background-size: cover;  background-position: center;}</style>